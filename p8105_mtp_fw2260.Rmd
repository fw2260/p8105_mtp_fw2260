---
title: "Midterm Project"
author: "Lily Wang"
date: "10/15/2020"
output: github_document
---

```{r setup}
library(tidyverse)
library(readxl)
library(janitor)
library(patchwork)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))
```

The `dogweights` dataset contains the weights of three dogs, Gagne, Simone, and Raisin, in pounds, along with some occasional notes, from 2018 to 2020. The dogs were weighed every few days and a standard weight was weighed occasionally as well to ensure accuracy. 

```{r clean_datasets}
dogweights_df <- 
  read_excel("./data/dogweights_07sept2020.xlsx",
    range = "B2:G207") %>% 
  clean_names() %>% 
  rename(notes = x6) %>% 
  filter(date != "s") %>% 
  mutate(
    date = as.numeric(date),
    date = excel_numeric_to_date(date, date_system = "modern"))

notes_df <- 
  select(dogweights_df, c(date, notes)) %>% 
  drop_na()

dogweights_df <-
  select(dogweights_df, !notes) %>% 
  pivot_longer(raisin:std,
               names_to = "name",
               values_to = "weight") %>% 
  relocate(date, name, weight) %>% 
  mutate(
    weight = recode(weight, "1810" = "18 10", "1803" = "18 03", "7 15" = "17 15")
  ) %>% 
  drop_na() %>% 
  separate(weight, c("lbs","oz"), " ") %>% 
  mutate(lbs = as.numeric(lbs),
         oz = as.numeric(oz),
         oz = oz/16,
         weight = lbs + oz) %>% 
  select(date, name, weight)

write_csv(dogweights_df, "./data/weights_cleaned.csv")
write_csv(notes_df, "./data/notes_cleaned.csv")

view(dogweights_df)
```

The cleaned `dogweights` dataset is `r nrow(dogweights_df)` rows and `r ncol(dogweights_df)` columns and does not contain notes. The weights in the original dataset were entered as pounds and ounces separated by a space, which were converted into pounds with decimals instead, for ease of visualization later. 

The notes from the original dataset were transferred to a separate `notes` dataframe that contains just the notes and the dates they were taken on.

**Incomplete entries:** Originally, one entry between 2019-01-19 and 2019-01-26 had an invalid date so it was deleted. Raisin's weights on 2018-10-22 and 2019-07-23 were missing a space so a space was added for consistency with the other entries. Also, Raisin's weight on 2019-08-14 was presumably missing a tens digit, so one was added. Finally, empty weight entries were deleted.

```{r plots}
distr_plot <- 
  dogweights_df %>% 
  filter(name != "std") %>% 
  ggplot(aes(x = name, y = weight, fill = name)) +
  geom_violin() +
  theme(legend.position = "none") +
  labs(
    title = "Weight distribution",
    x = "Dog",
    y = "Weight (pounds)"
  )

time_plot <-
  dogweights_df %>% 
  filter(name != "std") %>% 
  ggplot(aes(x = date, y = weight, color = name)) +
  geom_line() +   
  labs(
    title = "Weight over time",
    x = "Date",
    y = "Weight (pounds)",
    color = "Dog",
    caption = "Data from dogweights_07sept2020.xlsx"
  )

distr_plot + time_plot
```

Gagne and Simone are about the same weight (11 pounds or so) and Raisin is heavier by about 7 pounds. Over time, Gagne was losing a lot of weight rapidly closer to its death, Raisin lost a little weight, and Simone's weight stayed relatively constant.
